# Task Allocation System "Kraken" (backend by FastAPI)

[T.A.S.K. frontend](https://github.com/Czertilla/TASKraken-frontend)

## Описание

### Полное название "Task allocation system Kraken", АКА "T.A.S.K.", АКА "TASKraken"

Данная система позволяет автоматизировать процесс распределения, отслеживания и сдачи задач в рамках иерархии рабочего персонала.

### Иерархия сотрудников

У каждого пользователя может быть несколько ролей. Роль включает в себя совокупность прав внутри сервиса, а также определенное, жестко закрепленное, место в иерархии. **Роли** (АКА **Должности**) могут существовать только в рамках некоторой структуры. **Структуры** всегда вложены, за исключнием высшей структуры -- **Организации**.

#### Вот пример стандартной иерархии:

* Отдельные роли формируют иерархию команды, у каждой команды есть тимлид.
* Команды формируют отделы. Внутри отдела может быть одна команда. У каждого отдела есть директор.
* Отделы формируют организацию. Внутри организации может быть один отдел. **Организация** — обязательная и высшая в иерархии структура.

Вы можете создавать какие угодно вложенные друг в друга структуры.

### Бизнес-логика:

Существуют следующие сущности:

- Организация
  - Структура
    - должность (роль)
    - проект
      - Задача (в рамках проекта).
        - Атрибуты:
          - описание,
          - дедлайн,
          - ответственные,
          - чек-листы,
          - материалы (файлы).
        - Подзадача (в рамках задачи или подзадачи).
          - Атрибуты: то же, что и у задачи, но также основная задача.
        - Отчет (ответ на задачу по выполнению).
          - Атрибуты: материалы (файлы), задача.
          - Собщение обратной связи (в рамках задачи)
            - Атрибуты: текст, запрос на права, материалы
    - Подструктура

Руководящие в структуре роли могут назначать (при наличии соответствующего права, данного от его руководителя) любых пользователей на любые нижестоящие роли.

- [ ] Руководящие роли могут создавать новые структуры (при наличии права)
- [ ] Руководящие роли могут учреждать проект, в рамках которого создавать задачи
- [ ] Руководители отправляют на выполнение задачи своим подчиненным
- [ ] Подчиненным приходят уведомления о новых задачах с пометкой, соответствующей роли.
- [ ] Подчиненные могут отмечать пункты в чек-листах, отправлять сообщения обратной связи
- [ ] Подчиненные могут отправлять отчеты. Отчеты могут быть пустыми, только с пометкой о выполнении
- [ ] Руководители могут оценивать отчеты - Подчиненные могут оценивать задачи после выполнения и отправки отчета
- [ ] Любой сотрудник, который получил задачу (при наличии соответствующего права) создать подзадачи в рамках задачи и отправить на выполнение подчиненным ему сотрудникам.
- [ ] Сотрудниками приходят уведомления о приближающихся дедлайнах

### Сервис делится на две части.

1. Backend: веб-приложение,
   1. реализующее бизнес-логику посредством микросервисов,
   2. работу с базой данных посредством репозиториев и паттерна «unit of work»,
   3. общение с клиентом посредством роутеров.
2. Frontend: мобильное приложение, предоставляющее удобный интерфейс в качестве автоматизированного рабочего места.
   1. [ссылка на репозиторий](https://github.com/Czertilla/TASKraken-frontend)

# инструкция по установке

в понравившейся вам папочке прописываем:

```bash
$ git clone https://github.com/Czertilla/TASKraken-backend.git
```

## используя Docker

Для данного метода необходимо установить и запустить docker на вашей машине

Cоздаем файл с названием ".env-non-dev" с содержимым по следующему шаблону

```bash
DB_HOST=db
DB_PORT=5454
DB_NAME=
DB_USER=
DB_PASS=
DB_DBMS=postgres
USERS_SECTRET=
PASSW_SECTRET=
PYTHONPATH=src;test

POSTGRES_DB=
POSTGRES_USER=
POSTGRES_PASSWORD=
```

теперь строим docker compose из соответсвующего файла

```bash
$ docker compose build
```

Проект  готов к запуску, чтобы это сделать, просто пропишите

```bash
$ docker compose up
```

данные из базы данных сохраняются в тома, поэтому можно смело убрать все контейнеры
по команде

```bash
$ docker compose down
```

## используя вируальное окружение

Для данного метода необходимо установить и запустить PostgreSQL сервер на вашей машине

Необходимо инициализировать виртуальное окружение

```bash
$ py -m venv .venv
```

запустите виртуальное окружение (непосредствено файл .venv\Scripts\Activate.ps1) или

```bash
$ .venv\Scripts\Activate.ps1
```

теперь установите все необходимые библиотеки

```bash
$ pip install -r requirements.txt
```

теперь необходимо создать файл .env и записать туда данные по следующему шаблону

```
DB_HOST = localhost
DB_PORT = 
DB_NAME = 
DB_USER =
DB_PASS = 
DB_DBMS = postgres
USERS_SECTRET = 
PASSW_SECTRET =
```

теперь нужно запустить миграцию базы данных

```bash
$ alembic upgrade head
```

теперь остается только запустить uvicorn сервер и радоваться жизни

```bash
$ uvicorn main:app --reload
```

вы можете комбинировать методы docker и venv
